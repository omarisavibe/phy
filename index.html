<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AUC Physics | Lorentz Force Simulator</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #121212; /* Dark background so WHITE logo pops */
            color: #eee;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            display: flex;
            height: 100vh;
        }

        /* Controls Panel */
        #controls {
            width: 320px;
            background: #1e1e1e; /* Dark grey sidebar */
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
            z-index: 10;
            border-right: 1px solid #333;
        }

        /* LOGO CONTAINER */
        .logo-container {
            text-align: center;
            margin-bottom: 10px;
            padding-bottom: 15px;
            border-bottom: 1px solid #444;
        }

        /* The Logo Image Styling */
        #auc-logo {
            max-width: 180px;
            height: auto;
            display: block;
            margin: 0 auto;
            /* If the image fails to load, the alt text is styled here */
            color: #fff;
            font-weight: bold;
            font-size: 24px;
        }

        h1 { font-size: 1.1rem; color: #4db6ac; margin: 0; margin-top: 10px; text-align: center; }
        .subtitle { font-size: 0.8rem; color: #888; text-align: center; margin-top: 5px; }
        
        .control-group {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 8px;
        }
        
        label { display: block; font-size: 0.8rem; margin-bottom: 5px; color: #ccc; }
        
        input[type="range"] {
            width: 100%;
            cursor: pointer;
            accent-color: #4db6ac;
        }

        /* Button Styling */
        button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            font-size: 0.9rem;
        }
        #btn-reset { background: #d32f2f; color: white; }
        #btn-reset:hover { background: #b71c1c; }
        #btn-pause { background: #fbc02d; color: black; }
        #btn-pause:hover { background: #f9a825; }

        .preset-btn {
            width: 100%; 
            margin-bottom: 5px; 
            background: #37474f; 
            color: #eceff1;
            text-align: left;
            padding-left: 15px;
        }
        .preset-btn:hover { background: #455a64; }
        
        /* The Simulation Canvas */
        #canvas-container {
            flex-grow: 1;
            position: relative;
            background: radial-gradient(circle, #1a1a1a 0%, #000000 100%);
            cursor: crosshair;
        }
        
        canvas { display: block; }

        /* Overlay text on canvas */
        #overlay {
            position: absolute;
            top: 20px;
            right: 20px;
            text-align: right;
            pointer-events: none;
        }
        .hud-text {
            color: rgba(255, 255, 255, 0.4);
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            margin-bottom: 5px;
        }

        /* Vector Legend */
        .legend {
            font-size: 0.8rem;
            margin-top: 10px;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            color: #888;
        }
        .legend span { display: flex; align-items: center; gap: 6px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; }
    </style>
</head>
<body>

    <div id="controls">
        
        <div class="logo-container">
            <img id="auc-logo" src="auc_logo.png" alt="AUC" onerror="this.onerror=null; this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgNjAiPjx0ZXh0IHg9IjUwJSIgeT0iNjAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0ic2VyaWYiIGZvbnQtd2VpZ2h0PSJib2xkIiBmb250LXNpemU9IjUwIiBmaWxsPSIjZmZmZmZmIj5BVUM8L3RleHQ+PC9zdmc+';">
            
            <h1>PHYS 1021 Simulation</h1>
            <div class="subtitle">Chapter 11: Magnetic Forces</div>
        </div>

        <div class="control-group">
            <label>Magnetic Field (B) [Into/Out]</label>
            <input type="range" id="slider-B" min="-20" max="20" step="1" value="5">
            <div id="val-B" style="text-align: right; font-size: 0.8rem; color:#4fc3f7;">5.0 T</div>
        </div>

        <div class="control-group">
            <label>Electric Field (E) [Vertical]</label>
            <input type="range" id="slider-E" min="-10" max="10" step="0.5" value="0">
            <div id="val-E" style="text-align: right; font-size: 0.8rem; color:#e57373;">0.0 N/C</div>
        </div>

        <div class="control-group">
            <label>Particle Charge (q)</label>
            <input type="range" id="slider-q" min="-5" max="5" step="1" value="2">
            <div id="val-q" style="text-align: right; font-size: 0.8rem; color:#fff;">+2 C</div>
        </div>

        <div class="control-group">
            <label>Initial Velocity (v)</label>
            <input type="range" id="slider-v" min="0" max="30" step="1" value="10">
        </div>

        <div class="control-group">
            <label>Trail Persistence (Art Mode)</label>
            <input type="range" id="slider-trail" min="0.8" max="0.99" step="0.01" value="0.95">
        </div>

        <div style="display: flex; gap: 10px;">
            <button id="btn-pause" style="flex:1;">Pause</button>
            <button id="btn-reset" style="flex:1;">Reset</button>
        </div>

        <div class="control-group">
            <p style="margin-top:0; color:#fff;"><strong>Quick Presets:</strong></p>
            <button class="preset-btn" onclick="setPreset('cyclotron')">üåÄ Cyclotron (Spiral)</button>
            <button class="preset-btn" onclick="setPreset('selector')">üìè Velocity Selector (Straight)</button>
            <button class="preset-btn" onclick="setPreset('flower')">üé® Art: Magnetic Flower</button>
        </div>
    </div>

    <div id="canvas-container">
        <canvas id="simCanvas"></canvas>
        <div id="overlay">
            <div class="hud-text">Lorentz Force</div>
            <div class="hud-text" style="font-size: 1.2rem;">$\vec{F} = q(\vec{E} + \vec{v} \times \vec{B})$</div>
            <div class="legend">
                <span><span class="dot" style="background:#4fc3f7;"></span>Force</span>
                <span><span class="dot" style="background:#e57373;"></span>Velocity</span>
            </div>
        </div>
    </div>

    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>

    <script>
        // --- SETUP CANVAS ---
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;

        function resize() {
            width = canvas.width = document.getElementById('canvas-container').clientWidth;
            height = canvas.height = document.getElementById('canvas-container').clientHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        // --- PHYSICS STATE ---
        const state = {
            x: width / 2,
            y: height / 2,
            vx: 10,
            vy: 0,
            mass: 10,
            q: 2,
            B: 5,
            E: 0,
            traceFade: 0.95,
            paused: false
        };

        const ui = {
            B: document.getElementById('slider-B'),
            E: document.getElementById('slider-E'),
            q: document.getElementById('slider-q'),
            v: document.getElementById('slider-v'),
            trail: document.getElementById('slider-trail'),
            valB: document.getElementById('val-B'),
            valE: document.getElementById('val-E'),
            valQ: document.getElementById('val-q')
        };

        function updateParams() {
            state.B = parseFloat(ui.B.value);
            state.E = parseFloat(ui.E.value) * 5; 
            state.q = parseFloat(ui.q.value);
            state.traceFade = parseFloat(ui.trail.value);

            ui.valB.textContent = state.B.toFixed(1) + " T " + (state.B < 0 ? "(Out)" : "(In)");
            ui.valE.textContent = (state.E/5).toFixed(1) + " N/C";
            ui.valQ.textContent = (state.q > 0 ? "+" : "") + state.q + " C";
        }

        [ui.B, ui.E, ui.q, ui.trail].forEach(el => el.addEventListener('input', updateParams));
        
        window.setPreset = (type) => {
            resetSim();
            if (type === 'cyclotron') {
                ui.B.value = 8; ui.E.value = 0; ui.q.value = 2; ui.v.value = 15;
            } else if (type === 'selector') {
                ui.B.value = 5; ui.E.value = 10; ui.q.value = 2; ui.v.value = 10;
            } else if (type === 'flower') {
                ui.B.value = 12; ui.E.value = 0.5; ui.q.value = 3; ui.v.value = 20;
                ui.trail.value = 0.98; // High trail for art
            }
            updateParams();
            state.vx = parseFloat(ui.v.value);
        };

        document.getElementById('btn-reset').addEventListener('click', resetSim);
        document.getElementById('btn-pause').addEventListener('click', () => {
            state.paused = !state.paused;
        });
        
        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            state.x = e.clientX - rect.left;
            state.y = e.clientY - rect.top;
            state.vx = parseFloat(ui.v.value);
            state.vy = 0;
            ctx.fillStyle = "#000"; 
            ctx.fillRect(0,0,width,height);
        });

        function resetSim() {
            state.x = width / 2;
            state.y = height / 2;
            state.vx = parseFloat(ui.v.value);
            state.vy = 0;
            ctx.fillStyle = "#000"; 
            ctx.fillRect(0, 0, width, height);
            updateParams();
        }

        function updatePhysics() {
            if (state.paused) return;
            const dt = 0.15;
            
            // F = q(E + v x B)
            // B is Z-axis. v x B -> (vy*Bz, -vx*Bz, 0)
            const Fx = state.q * (state.vy * state.B * 0.1); 
            const Fy = state.q * (state.E - state.vx * state.B * 0.1); 

            const ax = Fx / state.mass;
            const ay = Fy / state.mass;

            state.vx += ax * dt;
            state.vy += ay * dt;
            state.x += state.vx * dt;
            state.y += state.vy * dt;

            // Bounce off walls
            if (state.x < 0 || state.x > width) state.vx *= -1;
            if (state.y < 0 || state.y > height) state.vy *= -1;
        }

        function draw() {
            // Trails
            ctx.fillStyle = `rgba(0, 0, 0, ${1 - state.traceFade})`;
            ctx.fillRect(0, 0, width, height);

            drawGrid();

            // Particle
            const color = state.q > 0 ? '#ffeb3b' : '#03a9f4'; 
            const glow = state.q > 0 ? 'rgba(255, 235, 59, 0.5)' : 'rgba(3, 169, 244, 0.5)';
            
            ctx.beginPath();
            ctx.arc(state.x, state.y, 6, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.shadowBlur = 15;
            ctx.shadowColor = glow;
            ctx.fill();
            ctx.shadowBlur = 0;

            // Vectors
            // Recalculate Force for vis
            const Fx = state.q * (state.vy * state.B * 0.1); 
            const Fy = state.q * (state.E - state.vx * state.B * 0.1); 
            
            drawVector(state.x, state.y, state.vx * 3, state.vy * 3, "#e57373"); // Velocity (Red)
            drawVector(state.x, state.y, Fx * 2, Fy * 2, "#4fc3f7"); // Force (Blue)
        }

        function drawVector(x, y, dx, dy, color) {
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + dx, y + dy);
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.stroke();
            // Arrowhead
            const angle = Math.atan2(dy, dx);
            ctx.beginPath();
            ctx.moveTo(x + dx, y + dy);
            ctx.lineTo(x + dx - 8 * Math.cos(angle - Math.PI / 6), y + dy - 8 * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(x + dx - 8 * Math.cos(angle + Math.PI / 6), y + dy - 8 * Math.sin(angle + Math.PI / 6));
            ctx.fillStyle = color;
            ctx.fill();
        }

        function drawGrid() {
            if (Math.abs(state.B) < 0.5) return;
            ctx.fillStyle = "rgba(255, 255, 255, 0.1)";
            ctx.font = "14px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            const symbol = state.B > 0 ? "√ó" : "‚Ä¢"; 
            for (let i = 25; i < width; i += 50) {
                for (let j = 25; j < height; j += 50) {
                    ctx.fillText(symbol, i, j);
                }
            }
        }

        resetSim();
        function loop() {
            updatePhysics();
            draw();
            requestAnimationFrame(loop);
        }
        loop();
    </script>
</body>
</html>
